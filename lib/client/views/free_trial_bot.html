<template name='freeTrialBot'>
  <div class='pg-bot'>
    <div class='pg-bot-header'>
      <h3 class='pg-bot-header-left'>Our Application Robot can help you choose a college by asking you 20 simple questions.</h3>

      <div class='pg-bot-header-right'>
        <form id='js-sms-handoff' data-step='{{ step }}'>
          <div class="type-small type-secondary pg-bot-header-right-explanation">Continue via text Message:</div>
          <input type='text' placeholder='123 - 456 - 7890'
          name='phone'
          class='js-sms-handoff-phone ui-form-phone ui-form-small'
          value='{{ currentUser.profile.phone }}' />
          <button class="ui-btn-secondary" type='submit js-sms-handoff' data-step='{{ step }}'>Go</button>
        </form>
      </div>
    </div>
    <div class='pg-bot-body'>
      <div class='pg-bot-question'>
        {{#with currentQuestion step }}
          {{#if showBeginBotTracker ../step}}
            <!-- Facebook Conversion Code for Began web-based bot -->
            <script>(function() {
              var _fbq = window._fbq || (window._fbq = []);
              if (!_fbq.loaded) {
                var fbds = document.createElement('script');
                fbds.async = true;
                fbds.src = '//connect.facebook.net/en_US/fbds.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(fbds, s);
                _fbq.loaded = true;
              }
            })();
            window._fbq = window._fbq || [];
            window._fbq.push(['track', '6021661227641', {'value':'0.00','currency':'USD'}]);
            </script>
            <noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?ev=6021661227641&amp;cd[value]=0.00&amp;cd[currency]=USD&amp;noscript=1" /></noscript>
          {{/if}}
          {{#if showParentContactInfoTracker ../step doc}}
            <!-- Facebook Conversion Code for Web-based bot Parent info given -->
            <script>(function() {
              var _fbq = window._fbq || (window._fbq = []);
              if (!_fbq.loaded) {
              var fbds = document.createElement('script');
              fbds.async = true;
              fbds.src = '//connect.facebook.net/en_US/fbds.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(fbds, s);
              _fbq.loaded = true;
              }
              })();
              window._fbq = window._fbq || [];
              window._fbq.push(['track', '6021661435241', {'value':'0.00','currency':'USD'}]);
            </script>
            <noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?ev=6021661435241&amp;cd[value]=0.00&amp;cd[currency]=USD&amp;noscript=1" /></noscript>
          {{/if}}
          {{#if done}}
            <p>
            Thanks, all done! We'll crunch some numbers and get back to you
            with the results.
            </p>
          {{else}}
            <div class='question-count type-large'>
              Question {{ num }} of {{ totalNum }}
            </div>
            <div class='question'>
              <h1>{{ question }}</h1>
            </div>
            <div class='answer'>
              {{#autoForm collection="FreeTrialBots" id="freeTrialBot" doc=doc }}
                <input type='hidden' value='{{ doc.userId }}' name='userId' data-schema-key='userId'/>
                {{#if loopn}}
                  <table>
                    <thead>
                      <tr>
                        {{#each loopn}}
                        <th>{{ prompt }}</th>
                        {{/each}}
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class='js-add-multiple-row'>
                        {{#each loopn}}
                          <td>
                            {{> afQuickField name=field options="auto" label-style="display: none"  style='width: 100%;' }}
                          </td>
                        {{/each}}
                        <td><button class='ui-btn js-add-multiple' data-step='{{ ../../step }}'>Add</button></td>
                      </tr>
                    {{#each table}}
                      <tr>
                        {{#each fields }}
                          <td>
                            {{ value }}
                          </td>
                        {{/each}}
                        <td>
                          <button class='ui-btn js-remove-multiple'
                            data-index='{{ index }}'
                            data-remove-schema-key='{{ schemaKey }}'>
                            Remove
                          </button>
                        </td>
                      </tr>
                    {{/each}}
                    </tbody>
                  </table>
                {{/if}}
                {{#if branch}}
                  {{#each branch}}
                    {{ prompt }}
                    {{> afQuickField name=field options="auto" label-style="display: none" }}
                  {{/each}}
                {{/if}}
                {{#if multipleBooleans }}
                  {{#each multipleBooleans}}
                    {{> afQuickField name=field options="auto" label-style="display: none" }}
                  {{/each}}
                {{/if}}
                {{#if field}}
                  {{> afQuickField name=field options="auto" label-style="display: none" }}
                {{/if}}
              {{/autoForm}}
            </div>
            <div class='nav ui-btn-set-middle'>
              <button class='js-nav-prev ui-btn-secondary ui-large' data-step='{{ ../step }}'
                {{prevDisabled ../step}}>Prev</button><button class='js-nav-next ui-btn ui-large' data-step='{{ ../step }}'
                {{nextDisabled ../step}}>Next</button>
            </div>
          {{/if}}
        {{/with}}
        {{ renderDatepickers }}
      </div>
      <div class='pg-bot-answers'>
        <h4 class="space-large">Your Answers</h4>
        <div class="type-small">
          {{#each allAnswers }}
          <div class='q-and-a space-large'>
            <div>
              <a href='{{ pathFor "freeTrialBot" step=step }}' class='js-scroll-top'>
                <span>{{ step }}.</span> {{ prompt }}
              </a>
            </div>
            {{ answer }}
          </div>
          {{/each}}
        </div>
      </div>
    </div>
  </div>
</template>
